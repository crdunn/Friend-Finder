<!DOCTYPE html>
<html>
<head>
	<title>survey</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<!-- 	<link rel="stylesheet" type="text/css" href="style.css"> -->
</head>
<body>
	
	<div class="container">
		<div class="row justify-content-center">
			<div class="card col-10">
				<div class="card-header">
					Question 1
				</div>
				<div class="card-body">
				  <div class="form-group">
				    <select class="form-control" id="q0">
				      <option>1</option>
				      <option>2</option>
				      <option>3</option>
				      <option>4</option>
				      <option>5</option>
				    </select>
				  </div>
				</div>
			</div>

			<div class="card col-10">
				<div class="card-header">
					Question 2
				</div>
				<div class="card-body">
				  <div class="form-group">
				    <select class="form-control" id="q1">
				      <option>1</option>
				      <option>2</option>
				      <option>3</option>
				      <option>4</option>
				      <option>5</option>
				    </select>
				  </div>
				</div>
			</div><br>

			<div class="card col-10">
				<div class="card-header">
					Question 3
				</div>
				<div class="card-body">
				  <div class="form-group">
				    <select class="form-control" id="q2">
				      <option>1</option>
				      <option>2</option>
				      <option>3</option>
				      <option>4</option>
				      <option>5</option>
				    </select>
				  </div>
				</div>
			</div><br>

			<div class="card col-10">
				<div class="card-header">
					Question 4
				</div>
				<div class="card-body">
				  <div class="form-group">
				    <select class="form-control" id="q3">
				      <option>1</option>
				      <option>2</option>
				      <option>3</option>
				      <option>4</option>
				      <option>5</option>
				    </select>
				  </div>
				</div>
			</div><br>

			<div class="card col-10">
				<div class="card-header">
					Question 5
				</div>
				<div class="card-body">
					<div class="form-group">
					    <select class="form-control" id="q4">
					      <option>1</option>
					      <option>2</option>
					      <option>3</option>
					      <option>4</option>
					      <option>5</option>
					    </select>
					</div>
				</div>
			</div><br>

			<div class="card col-10">
				<div class="card-header">
					Question 6
				</div>
				<div class="card-body">
				  <div class="form-group">
				    <select class="form-control" id="q5">
				      <option>1</option>
				      <option>2</option>
				      <option>3</option>
				      <option>4</option>
				      <option>5</option>
				    </select>
				  </div>
				</div>
			</div><br>

			<div class="card col-10">
				<div class="card-header">
					Question 7
				</div>
				<div class="card-body">
				  <div class="form-group">
				    <select class="form-control" id="q6">
				      <option>1</option>
				      <option>2</option>
				      <option>3</option>
				      <option>4</option>
				      <option>5</option>
				    </select>
				  </div>
				</div>
			</div><br>

			<div class="card col-10">
				<div class="card-header">
					Question 8
				</div>
				<div class="card-body">
				  <div class="form-group">
				    <select class="form-control" id="q7">
				      <option>1</option>
				      <option>2</option>
				      <option>3</option>
				      <option>4</option>
				      <option>5</option>
				    </select>
				  </div>
				</div>
			</div><br>

			<div class="card col-10">
				<div class="card-header">
					Question 9
				</div>
				<div class="card-body">
				  <div class="form-group">
				    <select class="form-control" id="q8">
				      <option>1</option>
				      <option>2</option>
				      <option>3</option>
				      <option>4</option>
				      <option>5</option>
				    </select>
				  </div>
				</div>
			</div><br>

			<div class="card col-10">
				<div class="card-header">
					Question 10
				</div>
				<div class="card-body">
				  <div class="form-group">
				    <select class="form-control" id="q9">
				      <option>1</option>
				      <option>2</option>
				      <option>3</option>
				      <option>4</option>
				      <option>5</option>
				    </select>
				  </div>
				</div>
			</div><br>
		</div>
	</div>

	<button class="submit">Submit</button>

</body>
	<script>
		var friendArray = [];
		var choiceIndex = 0;
		var newFriend = []
		//Once the submit button is clicked, the user's responses are found by jQuery and then placed in an array to be exported for the logic to use
		$(".submit").on("click", function(event) {
		      event.preventDefault();
		      var a0 = $("#q0").val();
		      var a1 = $("#q1").val();
		      var a2 = $("#q2").val();
		      var a3 = $("#q3").val();
		      var a4 = $("#q4").val();
		      var a5 = $("#q5").val();
		      var a6 = $("#q6").val();
		      var a7 = $("#q7").val();
		      var a8 = $("#q8").val();
		      var a9 = $("#q9").val();
		      newFriend = [a0,a1,a2,a3,a4,a5,a6,a7,a8,a9]
		      //console.log(newFriend);

		      // $.post("/api/friends", newFriend, function(data) {
		      // 	alert(data);
		      // });
		      findBest();
		});

		$.get("/api/friends", function(res,req){
			friendArray = res;
		});

		//this function correctly compares two arrays and finds the best match between them.
		function findBest(){
			var diffArray = [];
			var total = 0;
			var totalArray = [];
			//This for loop iterates through all of the avaiable friends
			for (var j = 0; j < friendArray.length; j++){
				var scoresArray = friendArray[j].scores
				//this for loop finds the absolute value of the difference between each element in the user's scores and the potential friends' scores
				for (var i = 0; i < newFriend.length; i++){
					diffArray[i] = Math.abs(newFriend[i] - scoresArray[i]);
					
				};
				//this loop add up the differences into one number
				for (var k = 0; k < diffArray.length; k++){
					total += diffArray[k];
				};
				//totalArray stores the total difference between the user and the potential friends at the same index
				totalArray[j] = total;
				//here, I reset the total variable to zero at the end of the loop
				total = 0
			};
			//this checks the entire total array and finds the smallest elementand returns it.  That is the potential firends with the smallest difference with the user.
			for (var l = 1; l < totalArray.length; l++){
				var p = l-1;
				if (totalArray[l] < totalArray[p]){
					choiceIndex = l;
				}else {
					choiceIndex = p;
				};

			};
			console.log(choiceIndex);
			alert("Your new friend is "+friendArray[choiceIndex].name);
		};





	</script>
</html>